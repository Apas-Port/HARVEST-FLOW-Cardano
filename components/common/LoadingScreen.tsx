"use client";

import React, { useEffect, useState } from 'react';

interface LoadingScreenProps {
  isVisible: boolean;
  onFadeOut?: () => void;
}

const LoadingScreen: React.FC<LoadingScreenProps> = ({ isVisible, onFadeOut }) => {
  const [shouldRender, setShouldRender] = useState(true);

  useEffect(() => {
    if (!isVisible) {
      // Fadeout animation for loading screen 500ms
      const timeout = setTimeout(() => setShouldRender(false), 500);
      return () => clearTimeout(timeout);
    } else {
      setShouldRender(true);
    }
  }, [isVisible]);

  // onFadeOutをレンダリング後に実行
  useEffect(() => {
    if (!shouldRender && onFadeOut) {
      onFadeOut();
    }
  }, [shouldRender, onFadeOut]);

  if (!shouldRender) {
    return null;
  }

  return (
    <div
      className={`flex items-center justify-center min-h-screen w-full bg-secondary transition-opacity duration-700 ${isVisible ? 'opacity-100' : 'opacity-0'}`}
      role="status"
      aria-label="Loading"
    >
      <svg className="animate-loading-fade" width="292" height="28" viewBox="0 0 292 28" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M5.19575 10.9638H16.4604V0.602539H21.6562V27.3908H16.4604V15.4623H5.19575V27.3908H0V0.602539H5.19575V10.9638Z" fill="white"/>
        <path d="M45.233 21.7676H34.4879L32.1281 27.3908H26.4922L37.9589 0.602539H42.0361L53.1781 27.3908H47.5855L45.2257 21.7676H45.233ZM43.7175 17.5085L39.9218 7.86556L36.126 17.5085H43.7175Z" fill="white"/>
        <path d="M65.7449 0.602539C69.418 0.602539 71.2942 1.56756 72.5355 2.61239C74.5705 4.33926 75.1694 6.63208 75.1694 8.63467C75.1694 11.2467 74.1302 13.5323 72.0519 14.9399C71.3736 15.4188 70.4139 15.8614 69.1366 16.1081L77.4425 27.3981H70.9695L63.8614 16.6305H63.2192V27.3981H58.0234V0.602539H65.7305H65.7449ZM63.2264 12.9301H64.7057C65.7016 12.9301 69.8221 12.8067 69.8221 8.87411C69.8221 4.94149 65.7449 4.85442 64.7923 4.85442H63.2336V12.9301H63.2264Z" fill="white"/>
        <path d="M84.3316 0.602539L91.4397 18.5968L98.5477 0.602539H104.22L92.9551 27.3908H89.8376L78.6523 0.602539H84.3244H84.3316Z" fill="white"/>
        <path d="M123.853 5.10111H114.263V11.0871H123.449V15.5857H114.263V22.8995H123.853V27.3981H109.074V0.602539H123.853V5.10111Z" fill="white"/>
        <path d="M143.573 6.70433C142.014 4.61467 140.174 4.41151 139.221 4.41151C136.421 4.41151 135.548 6.18191 135.548 7.546C135.548 8.19176 135.75 8.79399 136.385 9.35268C137.027 9.95491 137.901 10.2742 139.582 10.8764C141.66 11.602 143.616 12.3203 144.973 13.5683C146.17 14.6494 147.253 16.4633 147.253 19.1915C147.253 24.4157 143.5 27.9855 137.987 27.9855C133.073 27.9855 130.201 24.9743 128.801 22.921L132.192 19.6704C133.47 22.2825 135.909 23.2475 137.785 23.2475C140.145 23.2475 141.898 21.8036 141.898 19.5543C141.898 18.5893 141.581 17.8274 140.859 17.1454C139.863 16.2239 138.261 15.7015 136.746 15.1791C135.346 14.7002 133.672 14.0544 132.315 12.85C131.435 12.0881 130.201 10.6007 130.201 7.87251C130.201 3.93988 132.835 0 138.752 0C140.433 0 143.587 0.319253 146.3 3.13449L143.587 6.71158L143.573 6.70433Z" fill="white"/>
        <path d="M162.119 5.10111V27.3908H156.923V5.10111H150.934V0.602539H168.108V5.10111H162.119Z" fill="white"/>
        <path d="M198.824 5.10111H189.875V11.0871H198.261V15.5857H189.875V27.3981H184.68V0.602539H198.824V5.10111Z" fill="white"/>
        <path d="M209.254 1.09473V23.3844H217.481V27.883H204.059V1.09473H209.254Z" fill="white"/>
        <path d="M249.923 14.0181C249.923 22.1736 244.093 28 235.7 28C227.307 28 221.477 22.1736 221.477 14.0181C221.477 5.86266 227.307 0 235.7 0C244.093 0 249.923 5.86266 249.923 14.0181ZM244.569 14.0181C244.569 8.59808 240.896 4.73802 235.7 4.73802C230.504 4.73802 226.831 8.59083 226.831 14.0181C226.831 19.4455 230.504 23.2547 235.7 23.2547C240.896 23.2547 244.569 19.4382 244.569 14.0181Z" fill="white"/>
        <path d="M265.641 27.3905H261.723L252.457 0.602165H257.97L263.924 18.8359L270.433 0.355469H273.312L279.46 18.8359L285.854 0.602165H291.367L281.503 27.3905H277.584L271.753 10.3975L265.641 27.3905Z" fill="white"/>
      </svg>
    </div>
  );
};

export default LoadingScreen; 